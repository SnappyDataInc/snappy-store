SELECT  VD_INSTRUMENT_SCD.CUSIP_SRC_CD a7a0a0,
VD_TRADER_SCD.FIRM_ACCT_ID a1a4a2a9,
VD_TRADER_SCD.CCY_ID a6a9a9,
FACT1.pl_posn_id a6a9a5,
VD_POSN_EXTENDED_KEY.posn_ext_key_id a1a5a5a7,
FACT1.TM_ID a6a9a1,
VD_TRADER_SCD.LE_CD a6a7a1,
TL_SOURCE_SYSTEM.SRC_SYS_CD a1a1a9a4,
VD_TRADER_SCD.SUB_MICRO_CD a6a6a6,
VD_TRADER_SCD.STGY_CD a6a6a9,
VD_TRADER_SCD.FIRM_ACCT_MNEM_CD a6a8a9,
VD_INSTRUMENT_SCD.CUSIP_CD a6a9a6,
VD_INSTRUMENT_SCD.DEAL_CD a6a9a7,
VD_INSTRUMENT_SCD.TRAN_ID a1a1a9a5,
VD_POSN_EXTENDED_KEY.CORPUS_ID a7a0a4,
VD_TRADER_SCD.CCY_CD a6a9a4,
VD_INSTRUMENT_SCD.CUSIP_DESC a7a0a1,
VD_INSTRUMENT_SCD.OTC_CUSIP_CD a7a3a4,
VD_INSTRUMENT_SCD.FIT_CD a7a1a1,
VD_POSN_EXTENDED_KEY.LNG_SHRT_CD a1a0a6a9,
(FACT1.LTD_POSN_QTY+nvl(VF_PL_ADJUSTMENT.LTD_POSN_QTY,
 0.0) ) a3a2a8,
(DECODE((FACT1.LTD_POSN_QTY+NVL(VF_PL_ADJUSTMENT.LTD_POSN_QTY,
 0)) * VD_INSTRUMENT_SCD.PRC_FAC,
 0,
0,
(FACT1.LTD_MV_AMT+NVL(VF_PL_ADJUSTMENT.LTD_MV_AMT,
 0) )/ ( (FACT1.LTD_POSN_QTY+NVL(VF_PL_ADJUSTMENT.LTD_POSN_QTY,
 0) )* VD_INSTRUMENT_SCD.PRC_FAC )) )a3a8a2,
(DECODE((FACT1.LTD_POSN_QTY+NVL(VF_PL_ADJUSTMENT.LTD_POSN_QTY,
 0)) * VD_INSTRUMENT_SCD.PRC_FAC,
 0,
0,
(FACT1.LTD_USD_MV_AMT+NVL(VF_PL_ADJUSTMENT.LTD_USD_MV_AMT,
 0) )/ ( (FACT1.LTD_POSN_QTY+NVL(VF_PL_ADJUSTMENT.LTD_POSN_QTY,
 0) )* VD_INSTRUMENT_SCD.PRC_FAC )) )a3a9a8,
(FACT1.LTD_MV_AMT+nvl(VF_PL_ADJUSTMENT.LTD_MV_AMT,
 0.0) ) a1a3a2a0,
(FACT1.LTD_USD_MV_AMT+nvl(VF_PL_ADJUSTMENT.LTD_USD_MV_AMT,
 0.0) ) a1a3a2a2,
(FACT1.LTD_UREL_PL_AMT+nvl(VF_PL_ADJUSTMENT.LTD_UREL_PL_AMT,
 0.0) ) a3a2a9,
(FACT1.LTD_USD_UREL_PL_AMT+nvl(VF_PL_ADJUSTMENT.LTD_USD_UREL_PL_AMT,
 0.0) ) a3a8a0,
(FACT1.PTD_UREL_PL_AMT+nvl(VF_PL_ADJUSTMENT.PTD_UREL_PL_AMT,
 0.0) ) a2a6a2,
(FACT1.PTD_USD_UREL_PL_AMT+nvl(VF_PL_ADJUSTMENT.PTD_USD_UREL_PL_AMT,
 0.0) ) a3a3a2,
(FACT1.PTD_REV_OFS_AMT+nvl(VF_PL_ADJUSTMENT.PTD_REV_OFS_AMT,
 0.0) ) a2a9a8,
(FACT1.PTD_USD_REV_OFS_AMT+nvl(VF_PL_ADJUSTMENT.PTD_USD_REV_OFS_AMT,
 0.0) ) a3a6a7,
(FACT1.PTD_DIV_INCM_AMT+nvl(VF_PL_ADJUSTMENT.PTD_DIV_INCM_AMT,
 0.0) ) a2a6a5,
(FACT1.PTD_USD_DIV_INCM_AMT+nvl(VF_PL_ADJUSTMENT.PTD_USD_DIV_INCM_AMT,
 0.0) ) a3a3a5,
(FACT1.PTD_SD_FIN_EXPN_AMT+nvl(VF_PL_ADJUSTMENT.PTD_SD_FIN_EXPN_AMT,
 0.0) ) a2a9a6,
(FACT1.PTD_USD_SD_FIN_EXPN_AMT+nvl(VF_PL_ADJUSTMENT.PTD_USD_SD_FIN_EXPN_AMT,
 0.0) ) a3a6a5,
(FACT1.PTD_TOT_RLZD_AMT+nvl(VF_PL_ADJUSTMENT.PTD_TOT_RLZD_AMT,
 0.0) ) a3a9a0,
(FACT1.PTD_USD_TOT_RLZD_AMT+nvl(VF_PL_ADJUSTMENT.PTD_USD_TOT_RLZD_AMT,
 0.0) ) a4a0a6,
(FACT1.PTD_SD_AI_INCM_AMT+nvl(VF_PL_ADJUSTMENT.PTD_SD_AI_INCM_AMT,
 0.0) ) a2a9a2,
(FACT1.PTD_USD_SD_AI_INCM_AMT+nvl(VF_PL_ADJUSTMENT.PTD_USD_SD_AI_INCM_AMT,
 0.0) ) a3a6a2,
(FACT1.PTD_TOT_INST_CMSN_AMT+nvl(VF_PL_ADJUSTMENT.PTD_TOT_INST_CMSN_AMT,
 0.0) ) a3a8a8,
(FACT1.PTD_USD_TOT_INST_CMSN_AMT+nvl(VF_PL_ADJUSTMENT.PTD_USD_TOT_INST_CMSN_AMT,
 0.0) ) a4a0a4,
(FACT1.PTD_FX_PL_AMT+nvl(VF_PL_ADJUSTMENT.PTD_FX_PL_AMT,
 0.0) ) a2a6a3,
(FACT1.PTD_USD_FX_PL_AMT+nvl(VF_PL_ADJUSTMENT.PTD_USD_FX_PL_AMT,
 0.0) ) a3a3a3,
(FACT1.PTD_NET_ECON_PL_AMT+nvl(VF_PL_ADJUSTMENT.PTD_NET_ECON_PL_AMT,
 0.0) ) a3a9a4,
(FACT1.PTD_USD_NET_ECON_PL_AMT+nvl(VF_PL_ADJUSTMENT.PTD_USD_NET_ECON_PL_AMT,
 0.0) ) a4a1a0
FROM VD_TRADER_SCD,
VD_POSN_EXTENDED_KEY,
VF_PL_POSITION_PTD FACT1 left outer join  VF_PL_ADJUSTMENT on FACT1.tm_id=VF_PL_ADJUSTMENT.tm_id  AND
 FACT1.PL_POSN_ID=VF_PL_ADJUSTMENT.PL_POSN_ID,
TL_SOURCE_SYSTEM,
VD_INSTRUMENT_SCD WHERE FACT1.tm_id = 20120330  AND
 FACT1.FIRM_ACCT_ID = VD_TRADER_SCD.FIRM_ACCT_ID AND
 FACT1.CCY_ID = VD_TRADER_SCD.CCY_ID AND
 FACT1.SRC_SYS_ID = TL_SOURCE_SYSTEM.SRC_SYS_ID AND
 FACT1.POSN_EXT_KEY_ID = VD_POSN_EXTENDED_KEY.POSN_EXT_KEY_ID AND
 FACT1.INSM_ID = VD_INSTRUMENT_SCD.INSM_ID  AND
 (VD_TRADER_SCD.ACCT_GRP_NM in ('HK Generic Group',
'Japan GSSG-Tokyo',
'Equity Trading-Korea',
'Balanced Research - Hong Kong',
'Asia Pacific Credit Derivatives-Hong Kong',
'Asia Pacific Equity Derivatives',
'Finance Desk-Hong Kong',
'Emerging Markets Trading-Hong Kong',
'GSSG-Hong Kong',
'Equity Trading-Hong Kong') OR VD_TRADER_SCD.SUB_MICRO_CD in ('30EC',
'53YA',
'1BCA',
'60FI',
'30ED',
'67HF') OR VD_TRADER_SCD.FIRM_ACCT_MNEM_CD in ('BDRTRS01',
'BDRTAS01',
'BDRTAS02') OR VD_TRADER_SCD.STGY_CD in ('53A',
'344',
'53B',
'407',
'EB5',
'20C',
'95K',
'H1H',
'646',
'76W',
'W09',
'D18',
'A47',
'761'))  AND
 (FACT1.ERR_ID <> 33 OR (FACT1.err_id = 33 AND
  (VF_PL_ADJUSTMENT.PL_POSN_ID is not null  AND
 VF_PL_ADJUSTMENT.ERR_ID <> 33) ) ) ;
