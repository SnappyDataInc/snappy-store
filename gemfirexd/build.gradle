subprojects {
  ext {
    DERBY_NAME = 'Apache Derby'
    DERBY_MAJOR = '10'
    DERBY_MINOR = '4'
    DERBY_MAINT = '2000000'
    DERBY_DRDA_MAINT = '1'

    derbyProps = [ 'gemfirexd.version.major': DERBY_MAJOR,
        'gemfirexd.version.minor': DERBY_MINOR,
        'gemfirexd.version.maint': DERBY_MAINT,
        'gemfirexd.version.drdamaint': DERBY_DRDA_MAINT,
        'gemfirexd.build.number': '1',
        'gemfirexd.product.external.name': DERBY_NAME,
        'gemfirexd.product.external.version': "${DERBY_MAJOR}.${DERBY_MINOR}.${DERBY_MAINT}",
        'gemfirexd.version.beta': 'true',
        'gemfirexd.product.vendor': PRODUCT_VENDOR,
        'gemfirexd.product.file': 'gemfirexd.jar' ]

    locDir = 'com/pivotal/gemfirexd/internal/loc'
    clientMsgOutDir = "${project(subprojectBase + 'gemfirexd:core').buildDir}/client/${locDir}"
    if (!project.hasProperty("sanity")) {
      isSane = 'true'
    } else {
      isSane = sanity
    }
  }

  javadoc {
    options {
      windowTitle = 'GemFire XD Java API Documentation'
      docTitle = "<h1>GemFire XD ${project.version} Java API</h1>"
      header = "<i>GemFire XD ${project.version}</i>"
      bottom = '<i>Copyright &copy; 2010-2015 Pivotal Software, Inc. All rights reserved.</i>'
      use = true
      links = [ 'http://docs.oracle.com/javase/7/docs/api/' ]
      verbose = true
    }
  }
}

test.dependsOn subprojects.collect { p -> p.getTasksByName('test', false).collect { it.path } }
check.dependsOn subprojects.collect { p -> p.getTasksByName('check', false).collect { it.path } }

task generateSources {
  dependsOn subprojectBase + 'gemfirexd:core:compileJavacc'
  dependsOn subprojectBase + 'gemfirexd:core:generatePropertiesFiles'
  dependsOn subprojectBase + 'gemfire-core:createVersionPropertiesFile'
  dependsOn subprojectBase + 'gemfirexd:shared:createVersionPropertiesFile'
  dependsOn subprojectBase + 'gemfirexd:core:doSplit'
  dependsOn subprojectBase + 'gemfirexd:client:generatePropertiesFiles'
  dependsOn subprojectBase + 'gemfirexd:tools:compileJavacc'
  dependsOn subprojectBase + 'gemfirexd:tools:generatePropertiesFiles'
}
